<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>



<script>
/* console.log(111);
// 同步操作
var p1 = new Promise(function (resolve,reject){
    // resolve 方法的作用：使这个promise进入到成功状态
    // reject 方法的作用：使这个promise进入到失败状态
    // console.log('创建promise对象');
    console.log(222);
    resolve();
    // reject();
});

// 这里是异步操作
p1.then(function (){
    // console.log('成功');
    console.log(333);
},function (){
    // console.log('失败');
})

console.log(444); */


/* var p2 = new Promise(function (resolve,reject){
    // resolve('请求成功');
    // reject('请求失败');
    alertt('123');
    // throw new Error('alertt is not a function');
});
p2.then(function (res){
    console.log(res);//'请求成功'
},function (err){//promise内部发生错误或进入失败状态，会执行这里
    console.log(err);//请求失败
}); */



/* var p3 = new Promise(function (resolve,reject){
    resolve('请求成功');
    // reject('请求失败');
    // alertt('123');
    // throw new Error('alertt is not defiend');
});
p3.then(function (res){
    console.log(res);//'请求成功'
    // return '上一个promise执行成功';//代表下一个promise成功的返回值
    alertt(123);
},function (err){//promise内部发生错误或进入失败状态，会执行这里
    console.log(err);//请求失败
    return '上一个promise执行失败';//代表下一个promise成功的返回值
}).then(function (str){
    console.log(str);//上一个promise执行失败
},function (err){
    console.log(err);//ReferenceError: alertt is not defined
}); */


/* var p4 = new Promise(function (resolve,reject){
    resolve('请求成功');
    // reject('请求失败');
    // alertt('123');
    // throw new Error('alertt is not a function');
});
p4.then(function (res){
    console.log(res);//'请求成功'
    alertt('123');
},function (err){
    console.log(err);
}).catch(function (err){
    console.log(err);//ReferenceError: alertt is not defined
}); */


/* console.log('沈老板：A同学，你上课再睡觉，我抓到一次，赏你一管芥末');
var pm = new Promise(function (resolve,reject){
    console.log('A同学：老师，我保证以后上课不睡觉了！');
    var num = Math.ceil(Math.random()*10);//1-10
    if (num <= 5) {
        resolve('承诺兑现');
    } else {
        reject('承诺失败');
    }
});
pm.then(function (msg){
    console.log(msg);
},function (err){
    console.log(err);
});
console.log('沈老板：好的，看你以后的表现！'); */


// function returnPromise(){//惰性创建
//     return new Promise(function (resolve,reject){
//         resolve('成功');
//         // reject('失败');
//     });
// }
// returnPromise()
// .then(function (d){
//     console.log(d);
// },function (err){
//     console.log(err);
// });



// setTimeout(function (){
//     console.log('异步任务1');
//     setTimeout(function (){
//         console.log('异步任务2');
//         setTimeout(function (){
//             console.log('异步任务3');
//         },1000);
//     },1000);
// },1000);

// function doSomeThing(task){
//     return new Promise(function (resolve,reject){
//         setTimeout(function (){
//             resolve(task);
//         },1000);
//     });
// }
// doSomeThing('异步任务1')
// .then(function (d1){
//     console.log(d1);
//     return doSomeThing('异步任务2');
// })
// .then(function (d2){
//     console.log(d2);
//     return doSomeThing('异步任务3');
// })
// .then(function (d3){
//     console.log(d3);
// });



var p1 = new Promise(function (resolve,reject){
    resolve('任务1');
});
var p2 = new Promise(function (resolve,reject){
    // resolve('任务2');
    reject('失败2');
});
var p3 = new Promise(function (resolve,reject){
    resolve('任务3');
});

// Promise.all返回一个新的promise
Promise.all([p1,p2,p3])
.then(function (arr){
    console.log(arr);//["任务1", "任务2", "任务3"]
    console.log('任务4');
},function (err){
    console.log(err);
});



    
</script>
</body>
</html>